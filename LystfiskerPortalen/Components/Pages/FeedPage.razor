@page "/"
@using LystfiskerPortalen.Models

<div class="d-flex justify-content-center mb-3">
    <div style="width:45rem; display:flex; justify-content:space-between;">
        <button class="btn btn-outline-secondary">Sorter Efter:</button>
        <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#catchModal">Ny Fangst</button>
    </div>
</div>

<div class="d-flex flex-column align-items-center">
    <textarea class="form-control mb-4 border-4" 
        style="width:45rem; cursor:pointer;" 
        placeholder="Nyt opslag.."
        data-bs-toggle="modal" 
        data-bs-target="#CreatePostModal"></textarea>
    <CreatePostModal />
    
      
    @foreach (GeneralPost post in Posts)
    {
        <div class="card mb-5 border-3" style="width: 45rem;">
            <div class="card-body">
                <div class="card-title">
                    <div class="d-flex">
                        <h5>Profile</h5>
                        @if (post.IsQuestion)
                        {
                            <span class="badge bg-success ms-3 " style="height:23px ">Spørgsmål</span>
                        }
                    </div>
                </div>
                <p class="card-text">@post.PostTime</p>
                <p class="card-text">@post.Description</p>
                @if (!string.IsNullOrEmpty(post.Images[0].ImageName))
                {
                    foreach (Image img in post.Images)
                    {
                        <img class="card-img-top" src="@post.Images" alt="Card image">
                    }
                }
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">@post.Reactions.Count</li>
                @foreach (var comment in post.Comments)
                {
                    @* @comment.Profile.UserName mangler her, så vi kan se en profil på hver kommentar *@
                    <li class="list-group-item">@comment.Text</li>
                }
            </ul>
            <EditForm Model="post" class="card-text p-2">
                <InputTextArea class="form-control mt-2" @bind-Value="NewComment.Text"
                    Placeholder="Skriv en kommentar..." />
                <button type="submit" class="btn btn-primary mt-2">Kommenter</button>
            </EditForm>
        </div>
    }

</div>



@code {
    public GeneralPost NewPost { get; set; } = new GeneralPost();
    public Comment NewComment { get; set; } = new Comment();
    public List<Post> Posts { get; set; } = new List<Post>()
    {
        new GeneralPost 
        { 
            PostId = 1, 
            Description = "Jeg fangede en rødspætte", 
            IsQuestion = false, 
            Location = new Location
            {
                Name = "Odense Å" 
            }, 
            Images = new List<Image> {
                new Image { ImageName = "/Images/Makrel.jpg" }
            },
            PostTime = DateTime.Now, 
            Comments = new List<Comment>() 
            { 
                new Comment 
                {
                    CommentId = 1, CommentTime = DateTime.Now.AddHours(2), Text = "Wow tillykke!!" 
                },
                new Comment 
                {
                    CommentId = 2, CommentTime = DateTime.Now, Text = "Hvor er du sej"}},
                    Reactions = new List<Reaction> 
                    { 
                        new Reaction 
                        {
                            ReactionId = 1
                        }
                    }
            },
        new GeneralPost
        {
            PostId = 2,
            Description = "Hvor kan jeg fange makreller",
            IsQuestion = true,
            Location = new Location
            {
                Name = "Århus"
            },
            Images = new List<Image> {
                new Image { ImageName = "/Images/Makrel.jpg" }
            },
            PostTime = DateTime.Now,
            Comments = new List<Comment>
            {
                new Comment
                {
                    CommentId = 1, 
                    CommentTime = DateTime.Now.AddHours(2),
                    Text = "Du kan fange makreller i Århus havn"
                },
                new Comment
                {
                    CommentId = 2,
                    CommentTime = DateTime.Now,
                    Text = "Makreller kan fanges i søen"}
                },
            Reactions = new List<Reaction>
            {
                new Reaction
                {
                    ReactionId = 1
                },
                new Reaction
                {
                    ReactionId = 2
                }
            }
        },
    };
}