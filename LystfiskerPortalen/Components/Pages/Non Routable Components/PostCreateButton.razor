@using LystfiskerPortalen.Data
@using LystfiskerPortalen.Models
@using LystfiskerPortalen.Persistence
@using LystfiskerPortalen.Services
@inject IPostRepository PostRepository
@inject NavigationManager navManager
@inject ImageService ImageService
@rendermode InteractiveServer


<div class="modal-footer">
    <button type="button" @onclick="()=>CreatePost()" class="btn btn-primary w-100">Slå op</button>
</div>

@code{
    

    [Parameter]
    public string Description { get; set; }

    [CascadingParameter]
    public string ProfileId { get; set; }

    [Parameter]
    public bool IsQuestion { get; set; }


    [Parameter]
    public string PostType { get; set; }

    public void CreatePost()
    {
        navManager.Refresh();
        switch(PostType){
            case "general":
                CreateGeneralPost();
                break;
            case "catch":
                // Logic for creating a catch post
                break;
            case "event":
                // Logic for creating a catch post
                break;
        }

    }

    public void CreateGeneralPost()
    {
        var generalPost = new GeneralPost
        {
            PostTime = DateTime.UtcNow,
            Description = Description,
            Location = new Location
            {
                Name = "Placeholder",
                Latitude = 0.0,
                Longitude = 0.0
            },
                ProfileId = "67066540-31fb-423f-b29b-2020f8d54b1d",
            IsQuestion = IsQuestion,
            Images = ImageService.GetImages()

        };
        PostRepository.Add(generalPost);
        Console.WriteLine("General Post Created");
    }
   
   
}
